<h2><%= destination.city %>, <%= destination.stateOrCountry %></h2>
<img src="<%= destination.image %>" alt="<%= destination.city %>-pic">
<h4>Population: <%= destination.population %></h4>

<hr>

<h3>Weather</h3>

<h4>Current</h4>
    <ul>
        <li>Temperature: <%= results.current.temperature %> F</li>
        <li>Visibility: <%= results.current.skytext %></li>
        <li>Feels Like: <%= results.current.feelslike %> F</li>
        <li>Wind: <%= results.current.winddisplay %></li>
    </ul>

<h4>3-Day Forecast</h4>

<div class="row">
    <% for (let i = 0; i < 3; i++) { %>
        <div class="col-4">
            <div class="card">
                <h5><%= results.forecast[i].day %></h5>
                    <ul>
                        <li>Low: <%= results.forecast[i].low %> F</li>
                        <li>High: <%= results.forecast[1].high %> F</li>
                        <li>Visibility: <%= results.forecast[1].skytextday %></li>
                    </ul>
            </div>
        </div>    
    <% } %>
</div>

<hr>

<h3>Reviews</h3>

<% if (currentUser) { %>
    <%- include("../reviews/new") %>
<% } %>

<hr>

<% if (reviews[0] !== undefined) { %>
    <div class="row">
        <% reviews.forEach(function(review) { %>
            <div class="col-6">
                <div class="card">
                    <% if (currentUser && currentUser.id == review.user.id) { %>
                        <!-- Edit Modal -->
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editReview-<%= review.id %>">Edit</button>

                        <div class="modal fade" id="editReview-<%= review.id %>" tabindex="-1" aria-labelledby="editReviewLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="editReviewLabel">Edit Review</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form action="/destinations/<%= destination.id %>/<%= review.id %>/?_method=PUT" method="POST">
                                            <label for="destination"><%= destination.city %>, <%= destination.stateOrCountry %></label>
                                        
                                            <label for="user">By: <%= review.user.firstName %> <%= review.user.lastName %></label>
                                        
                                            <label for="content">Review:</label>
                                            <input id="content" type="text" name="content" value="<%= review.content %>">
                                        
                                            <label for="rating">Rating:</label>
                                            <input id="rating" type="number" name="rating" min="1" max="5" value="<%= review.rating %>">
                                        
                                            <input type="submit" value="Save Review">
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <a href="#" data-bs-dismiss="modal"></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Delete Modal -->
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal-delete-review-<%= review.id %>" data-bs-target="#deleteReview-<%= review.id %>">Delete</button>
                        <div class="modal fade" id="deleteReview-<%= review.id %>" tabindex="-1" aria-labelledby="deleteReviewLabel">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="deleteReviewLabel">Delete Review</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <p>Are you sure?</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                                        <form action="/destinations/<%= destination.id %>/<%= review.id %>/?_method=DELETE" method="POST">
                                            <input class="btn btn-primary" type="submit" value="Delete">
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <% } %>
                    <div class="row justify-content-around">
                        <h5 class="col"><%= review.user.firstName %> <%= review.user.lastName %></h5>
                        <h4 class="col"><%= review.rating %></h4>
                    </div>
                    <p><%= review.content %></p>
                </div>
            </div>
        <% }) %>
    </div>
<% } else { %>
    <h3>No Reviews</h3>
<% } %>

<hr>

<% if (currentUser && currentUser.id === 1) { %>
    <%- include("../partials/deleteDest") %>
<% } %>